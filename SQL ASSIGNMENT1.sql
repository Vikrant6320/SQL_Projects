                    /* BASIC QUESTIONS */

CREATE DATABASE BRANDS

CREATE DATABASE PRODUCTS

USE BRANDS

CREATE TABLE ITEMS_TABLE
(
ITEM_ID INT PRIMARY KEY,
ITEM_DESCRIPTION VARCHAR(100),
VENDOR INT,
VENDOR_NAME VARCHAR(100),
BOTTLE_SIZE INT,
BOTTLE_PRICE MONEY
)

SELECT * FROM ITEMS_TABLE

INSERT INTO ITEMS_TABLE VALUES (1,'TRAVIS HASSE APPLE PIE',305,'MHW LTD',750,9.77)



USE PRODUCTS

CREATE TABLE PRODUCTS_TABLE
(
PRODUCT_ID INT PRIMARY KEY,
COUNTRY VARCHAR(100),
PRODUCT VARCHAR(100),
UNITS_SOLD VARCHAR(100),
MANUFACTURING_PRICE MONEY,
SALE_PRICE MONEY,
GROSS_SALES MONEY,
SALES MONEY,
COGS MONEY,
PROFIT MONEY,
DATE DATE,
MONTH_NUMBER INT,
MONTH_NAME VARCHAR(100),
YEAR INT
)

INSERT INTO PRODUCTS_TABLE
VALUES
(1,'CANADA','CARRETERA',1618.5,3.00,20.00,32370.00,32370.00,16185.00,16185.00,'01-01-2014',1,'JANUARY',2014)

SELECT * FROM PRODUCTS_TABLE

INSERT INTO PRODUCTS_TABLE VALUES(2,'GERMANY','CARRETERA',1321,3.00,20.00,26420,26420,13210,13210,'01-01-2014',1,'JANUARY',2015)
INSERT INTO PRODUCTS_TABLE VALUES(3,'FRANCE','CARRETERA',2178,3,15,32670,32670,21780,10890,'01-06-2014',6,'JUNE',2016)
INSERT INTO PRODUCTS_TABLE VALUES(4,'GERMANY','CARRETERA',888,3,15,13320,13320,8880,4440,'01-06-2014',6,'JUNE',2017)
INSERT INTO PRODUCTS_TABLE VALUES(5,'MEXICO','CARRETERA',2470,3,15,37050,37050,24700,12350,'01-06-2014',6,'JUNE',2018)
INSERT INTO PRODUCTS_TABLE VALUES(6,'GERMANY','CARRETERA',1513,3,350,529550,529550,393380,136170,'01-12-2014',12,'DECEMBER',2019)
INSERT INTO PRODUCTS_TABLE VALUES(7,'GERMANY','MONTANA',921,5,15,13815,13815,9210,4605,'01-03-2014',3,'MARCH',2020)
INSERT INTO PRODUCTS_TABLE VALUES(8,'CANADA','MONTANA',2518,5,12,30216,30216,7554,22662,'01-06-2014',6,'JUNE',2021)




DELETE FROM PRODUCTS_TABLE
WHERE
UNITS_SOLD='1618.5'


DELETE FROM PRODUCTS_TABLE
WHERE
UNITS_SOLD='888'


DELETE FROM PRODUCTS_TABLE
WHERE
UNITS_SOLD='2470'

SELECT * FROM PRODUCTS_TABLE

DROP TABLE PRODUCTS_TABLE

DROP TABLE ITEMS_TABLE

CREATE TABLE ITEMS_TABLE
(
ITEM_ID INT PRIMARY KEY,
ITEM_DESCRIPTION VARCHAR(100),
VENDOR INT,
VENDOR_NAME VARCHAR(100),
BOTTLE_SIZE INT,
BOTTLE_PRICE MONEY
)

SELECT * FROM ITEMS_TABLE

INSERT INTO ITEMS_TABLE VALUES (1,'TRAVIS HASSE APPLE PIE',305,'MHW LTD',750,9.77)


CREATE TABLE PRODUCTS_TABLE
(
PRODUCT_ID INT PRIMARY KEY,
COUNTRY VARCHAR(100),
PRODUCT VARCHAR(100),
UNITS_SOLD VARCHAR(100),
MANUFACTURING_PRICE MONEY,
SALE_PRICE MONEY,
GROSS_SALES MONEY,
SALES MONEY,
COGS MONEY,
PROFIT MONEY,
DATE DATE,
MONTH_NUMBER INT,
MONTH_NAME VARCHAR(100),
YEAR INT
)

INSERT INTO PRODUCTS_TABLE
VALUES
(1,'CANADA','CARRETERA',1618.5,3.00,20.00,32370.00,32370.00,16185.00,16185.00,'01-01-2014',1,'JANUARY',2014)

SELECT * FROM PRODUCTS_TABLE

INSERT INTO PRODUCTS_TABLE VALUES(2,'GERMANY','CARRETERA',1321,3.00,20.00,26420,26420,13210,13210,'01-01-2014',1,'JANUARY',2015)
INSERT INTO PRODUCTS_TABLE VALUES(3,'FRANCE','CARRETERA',2178,3,15,32670,32670,21780,10890,'01-06-2014',6,'JUNE',2016)
INSERT INTO PRODUCTS_TABLE VALUES(4,'GERMANY','CARRETERA',888,3,15,13320,13320,8880,4440,'01-06-2014',6,'JUNE',2017)
INSERT INTO PRODUCTS_TABLE VALUES(5,'MEXICO','CARRETERA',2470,3,15,37050,37050,24700,12350,'01-06-2014',6,'JUNE',2018)
INSERT INTO PRODUCTS_TABLE VALUES(6,'GERMANY','CARRETERA',1513,3,350,529550,529550,393380,136170,'01-12-2014',12,'DECEMBER',2019)
INSERT INTO PRODUCTS_TABLE VALUES(7,'GERMANY','MONTANA',921,5,15,13815,13815,9210,4605,'01-03-2014',3,'MARCH',2020)
INSERT INTO PRODUCTS_TABLE VALUES(8,'CANADA','MONTANA',2518,5,12,30216,30216,7554,22662,'01-06-2014',6,'JUNE',2021)




                    /* Intermediate Questions */

					       /* BIG TABLE */


/* FIND THE TOTAL SALE PRICE AND GROSS SALES */

SELECT SUM(SALE_PRICE), SUM(GROSS_SALES) FROM PRODUCTS_TABLE


/* IN WHICH YEAR WE HAVE GOT THE HIGHEST SALES */

SELECT YEAR_ FROM PRODUCTS_TABLE
WHERE SALES=(SELECT MAX(SALES) FROM PRODUCTS_TABLE)


/* WHICH PRODUCT HAVING THE SALES OF $ 37,050.00 */

SELECT PRODUCT FROM PRODUCTS_TABLE
WHERE SALES=37050


/* WHICH COUNTRIES LIES BETWEEN PROFIT OF $ 4,605 TO $ 22,662.00 */

SELECT COUNTRY COUNTRY FROM PRODUCTS_TABLE
WHERE PROFIT BETWEEN 4605 AND 22662


/* WHICH PRODUCT ID HAVING THE SALES OF $ 24,700.00 */

SELECT PRODUCT_ID PRODUCT_ID FROM PRODUCTS_TABLE
WHERE SALES=24700


                   /* SMALL TABLE */


USE BRANDS

SELECT * FROM ITEMS_TABLE


/* FIND THE ITEM_DESCRIPTION HAVING THE BOTTLE SIZE OF 750 */

SELECT ITEM_DESCRIPTION FROM ITEMS_TABLE
WHERE
BOTTLE_SIZE=750


/* FIND THE VENDOR NAME HAVING THE VENDOR_NOS 305,380,391 */

SELECT VENDOR_NAME FROM ITEMS_TABLE
WHERE
VENDOR IN (305,380,391)



/* WHAT IS TOTAL BOTTLE_PRICE */

SELECT SUM(BOTTLE_PRICE) TOTAL_BOTTLE_PRICE FROM ITEMS_TABLE


/* MAKE PRIMARY KEY TO ITEM_ID */

ALTER TABLE ITEMS_TABLE
ADD CONSTRAINT VENDOR PRIMARY KEY(ITEM_ID)


/* WHICH ITEM ID HAVING THE BOTTLE PRICE OF $ 5.06 */

SELECT ITEM_DESCRIPTION FROM ITEMS_TABLE
WHERE
BOTTLE_PRICE=5.06


                    /* ADVANCE QUESTIONS */

/* APPLY INNER, FULL OUTER, LEFT JOIN TYPES ON BOTH THE TABLE */

SELECT ITEMS_TABLE.ITEM_DESCRIPTION,PRODUCTS_TABLE.COUNTRY
FROM BRANDS.dbo.ITEMS_TABLE
INNER JOIN
PRODUCTS.dbo.PRODUCTS_TABLE
ON
BRANDS.dbo.ITEMS_TABLE.ITEM_ID=PRODUCTS.dbo.PRODUCTS_TABLE.PRODUCT_ID



SELECT ITEMS_TABLE.ITEM_ID,ITEM_DESCRIPTION,VENDOR,VENDOR_NAME,BOTTLE_SIZE,BOTTLE_PRICE,PRODUCTS_TABLE.PRODUCT_ID,COUNTRY,PRODUCT,UNITS_SOLD,MANUFACTURING_PRICE,SALE_PRICE,GROSS_SALES,SALES,COGS,PROFIT,DATE,MONTH_NUMBER,MONTH_NAME,YEAR_
FROM BRANDS.dbo.ITEMS_TABLE
FULL OUTER JOIN
PRODUCTS.dbo.PRODUCTS_TABLE
ON
BRANDS.dbo.ITEMS_TABLE.ITEM_ID=PRODUCTS.dbo.PRODUCTS_TABLE.PRODUCT_ID



SELECT ITEMS_TABLE.ITEM_ID,ITEM_DESCRIPTION,VENDOR,VENDOR_NAME,BOTTLE_SIZE,BOTTLE_PRICE,PRODUCTS_TABLE.COUNTRY
FROM BRANDS.dbo.ITEMS_TABLE
LEFT JOIN
PRODUCTS.dbo.PRODUCTS_TABLE
ON
BRANDS.dbo.ITEMS_TABLE.ITEM_ID=PRODUCTS.dbo.PRODUCTS_TABLE.PRODUCT_ID


/* Apply  OUTER  ,  RIGHT JOIN , CROSS JOIN types  on both the table */

SELECT ITEMS_TABLE.ITEM_ID,ITEM_DESCRIPTION,VENDOR,VENDOR_NAME,BOTTLE_SIZE,BOTTLE_PRICE,PRODUCTS_TABLE.PRODUCT_ID,COUNTRY,PRODUCT,UNITS_SOLD,MANUFACTURING_PRICE,SALE_PRICE,GROSS_SALES,SALES,COGS,PROFIT,DATE,MONTH_NUMBER,MONTH_NAME,YEAR_
FROM BRANDS.dbo.ITEMS_TABLE
FULL OUTER JOIN
PRODUCTS.dbo.PRODUCTS_TABLE
ON
BRANDS.dbo.ITEMS_TABLE.ITEM_ID=PRODUCTS.dbo.PRODUCTS_TABLE.PRODUCT_ID


SELECT ITEMS_TABLE.ITEM_DESCRIPTION,PRODUCTS_TABLE.PRODUCT_ID,COUNTRY,PRODUCT,UNITS_SOLD,MANUFACTURING_PRICE,SALE_PRICE,GROSS_SALES,SALES,COGS,PROFIT,DATE,MONTH_NUMBER,MONTH_NAME,YEAR_
FROM BRANDS.dbo.ITEMS_TABLE
RIGHT JOIN
PRODUCTS.dbo.PRODUCTS_TABLE
ON
BRANDS.dbo.ITEMS_TABLE.ITEM_ID=PRODUCTS.dbo.PRODUCTS_TABLE.PRODUCT_ID


SELECT ITEMS_TABLE.ITEM_DESCRIPTION,PRODUCTS_TABLE.COUNTRY
FROM BRANDS.dbo.ITEMS_TABLE
CROSS JOIN
PRODUCTS.dbo.PRODUCTS_TABLE
ON
BRANDS.dbo.ITEMS_TABLE.ITEM_ID=PRODUCTS.dbo.PRODUCTS_TABLE.PRODUCT_ID


/* Find the item_description and Product having the gross sales of 13,320.00 */

SELECT ITEMS_TABLE.ITEM_DESCRIPTION,PRODUCTS_TABLE.PRODUCT
FROM BRANDS.dbo.ITEMS_TABLE
JOIN
PRODUCTS.dbo.PRODUCTS_TABLE
ON
BRANDS.dbo.ITEMS_TABLE.ITEM_ID=PRODUCTS.dbo.PRODUCTS_TABLE.PRODUCT_ID
WHERE PRODUCTS_TABLE.GROSS_SALES=13320


/* Combine the  bottle_price and profit Column and show total value of both the columns in a new temporary columns */


SELECT ITEMS_TABLE.BOTTLE_PRICE,PRODUCTS_TABLE.PROFIT,(BOTTLE_PRICE+PROFIT) AS TOTAL_VALUE
FROM BRANDS.dbo.ITEMS_TABLE
JOIN
PRODUCTS.dbo.PRODUCTS_TABLE
ON
BRANDS.dbo.ITEMS_TABLE.ITEM_ID=PRODUCTS.dbo.PRODUCTS_TABLE.PRODUCT_ID



/* Split the Item_description Column into Columns Item_desc1 and Item_desc2 */


SELECT
	SUBSTRING(ITEM_DESCRIPTION,1,CHARINDEX(' ',ITEM_DESCRIPTION)-1)AS ITEM_DESC1,
	SUBSTRING(ITEM_DESCRIPTION,CHARINDEX(' ',ITEM_DESCRIPTION)+1,LEN(ITEM_DESCRIPTION)) AS ITEM_DESC2
FROM ITEMS_TABLE
